# RoseDB
学习基于Bitcask实现的Go语言RoseDB

1. 数据库文件的设计：直接打开文件，直接追加写到文件中，每个数据结构都打开一个文件提供读写；
   并在内存中维护一个索引结构，其中保存了记录所在的文件id和文件中的offset;
2. 5种数据结构, 每种数据结构的写入，都会在内存保留一份其在数据文件中的位移信息，方便下次读取;
3. 每种数据结构的更新||删除，都会向后台其GC协程发送数据失效信息，实时监测数据文件中的冗余数据量，以便及时清除失效记录，提高磁盘利用率;
4. 当前提供读写的文件大小到达一定阈值后，保存成非活跃文件，并新建活跃文件，此时内存中的索引结构不做任何更改;
5. 每种数据结构文件后台都运行一个GC协程，不断进行判断每个文件的冗余率，当文件中的失效数据达到一定阈值后，那么就对此文件进行重新编排:
   打开文件，重新在内存中执行一遍文件中的内容，那么此时内存会 更新 || 删除 旧值
6. 打开数据库后，会从数据文件中，依次读取每条记录，构建索引，根据不同的数据类型，构建不同的内存索引树
7. 

